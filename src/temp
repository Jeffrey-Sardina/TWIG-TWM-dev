using splits:
test_ids (121): [106, 958, 709, 473, 122, 945, 892, 22, 1207, 1108, 752, 416, 1049, 1006, 918, 64, 806, 798, 610, 633, 9, 227, 340, 427, 775, 35, 772, 941, 47, 409, 189, 1154, 51, 161, 614, 836, 151, 651, 402, 413, 289, 445, 1070, 20, 37, 645, 1181, 525, 627, 1040, 1078, 972, 266, 158, 817, 1097, 763, 448, 11, 130, 476, 1141, 961, 930, 888, 1134, 906, 573, 527, 1087, 732, 1010, 5, 579, 914, 1057, 367, 168, 1071, 153, 249, 226, 1137, 878, 1169, 604, 199, 599, 36, 1184, 1048, 307, 414, 419, 542, 1143, 134, 791, 1088, 1058, 1073, 512, 788, 555, 38, 552, 1043, 1128, 640, 1167, 154, 212, 114, 1211, 357, 757, 701, 410, 279, 964, 601]
valid_ids (0): []
train_ids (1082): [1022, 81, 903, 534, 1024, 812, 792, 979, 144, 172, 132, 363, 467, 95, 124, 269, 301, 783, 560, 315, 554, 533, 794, 284, 264, 822, 1131, 477, 514, 63, 1099, 71, 49, 971, 621, 655, 443, 372, 68, 839, 909, 1033, 733, 561, 184, 948, 1117, 403, 576, 977, 781, 135, 12, 87, 743, 77, 687, 616, 572, 228, 535, 770, 418, 585, 974, 823, 177, 719, 1144, 591, 1060, 575, 898, 513, 1090, 174, 1152, 807, 482, 246, 19, 905, 220, 1193, 921, 539, 590, 884, 150, 679, 652, 1194, 162, 148, 101, 628, 820, 697, 662, 489, 1140, 235, 208, 442, 595, 30, 957, 337, 949, 415, 278, 192, 684, 449, 619, 854, 475, 1015, 975, 1034, 282, 713, 1020, 864, 251, 193, 344, 698, 380, 1041, 86, 221, 230, 563, 1171, 326, 848, 69, 385, 858, 280, 956, 327, 258, 920, 815, 89, 668, 435, 777, 637, 784, 399, 140, 15, 72, 257, 1053, 211, 725, 570, 635, 310, 1170, 209, 818, 760, 714, 452, 149, 1008, 927, 893, 1208, 577, 94, 55, 580, 550, 186, 797, 263, 935, 104, 1103, 578, 847, 1183, 1196, 83, 1210, 238, 378, 183, 138, 636, 660, 587, 432, 287, 962, 657, 370, 79, 156, 600, 996, 1151, 852, 2, 173, 870, 939, 335, 321, 1146, 630, 574, 902, 1214, 922, 680, 605, 286, 695, 394, 1163, 558, 540, 626, 1186, 248, 355, 27, 545, 1150, 421, 429, 1051, 206, 726, 388, 734, 58, 491, 894, 951, 654, 518, 366, 673, 1187, 484, 207, 766, 233, 48, 1052, 205, 214, 916, 43, 376, 963, 976, 125, 966, 181, 1139, 204, 1012, 103, 865, 837, 386, 785, 93, 826, 126, 57, 210, 773, 594, 216, 603, 260, 915, 987, 180, 908, 395, 583, 581, 622, 361, 740, 508, 1166, 478, 1123, 676, 786, 819, 1063, 334, 629, 543, 944, 739, 1114, 1129, 495, 850, 232, 256, 886, 1130, 917, 804, 34, 100, 75, 1055, 453, 166, 774, 16, 615, 33, 92, 3, 433, 143, 693, 969, 764, 1038, 1069, 325, 268, 1190, 46, 608, 717, 1021, 524, 1122, 96, 319, 1075, 422, 1149, 341, 136, 1164, 469, 1104, 767, 509, 1047, 188, 236, 571, 612, 912, 109, 382, 913, 1153, 735, 119, 696, 362, 910, 711, 625, 934, 796, 868, 670, 470, 45, 458, 6, 231, 692, 720, 1189, 849, 1, 653, 108, 1032, 989, 1031, 727, 1091, 291, 933, 1212, 1004, 1079, 1094, 1011, 374, 649, 396, 891, 311, 32, 240, 171, 500, 170, 1158, 929, 1113, 667, 547, 1201, 121, 1198, 707, 157, 369, 750, 197, 827, 1106, 965, 356, 876, 293, 1039, 461, 992, 833, 387, 801, 97, 838, 883, 1100, 265, 304, 217, 809, 1124, 666, 1002, 447, 731, 25, 988, 741, 499, 1095, 689, 528, 702, 1046, 242, 1121, 846, 1120, 765, 504, 411, 479, 348, 1028, 609, 843, 955, 389, 844, 129, 510, 239, 661, 98, 1112, 889, 659, 471, 111, 455, 223, 505, 1115, 646, 1161, 275, 1096, 700, 755, 185, 1013, 541, 811, 842, 400, 618, 42, 112, 808, 592, 754, 1125, 105, 437, 294, 688, 213, 973, 252, 1016, 273, 441, 718, 234, 613, 736, 880, 290, 276, 10, 761, 190, 940, 1199, 113, 998, 1025, 147, 841, 67, 745, 270, 1118, 890, 780, 829, 802, 342, 65, 871, 1175, 855, 195, 350, 516, 749, 1204, 1062, 1173, 529, 1109, 1003, 907, 919, 519, 779, 793, 778, 520, 74, 748, 879, 420, 1111, 716, 853, 169, 795, 551, 371, 1155, 4, 900, 877, 244, 262, 52, 8, 675, 99, 1180, 938, 1127, 768, 1145, 377, 831, 904, 954, 296, 1195, 267, 960, 896, 318, 464, 128, 993, 430, 683, 41, 1188, 800, 588, 685, 593, 468, 218, 254, 1168, 480, 790, 405, 602, 312, 53, 1084, 200, 23, 247, 381, 1023, 80, 127, 875, 29, 332, 1192, 390, 860, 351, 21, 222, 313, 474, 339, 329, 862, 950, 729, 198, 159, 91, 816, 549, 241, 1007, 39, 506, 947, 607, 669, 17, 1098, 1018, 115, 803, 303, 271, 229, 462, 61, 643, 682, 261, 857, 1205, 85, 426, 360, 481, 824, 715, 338, 1019, 349, 14, 1037, 384, 1160, 28, 259, 565, 923, 404, 721, 460, 1014, 90, 946, 507, 672, 281, 911, 840, 690, 18, 931, 438, 31, 753, 152, 984, 440, 492, 298, 1074, 54, 465, 417, 1138, 423, 986, 553, 1042, 1092, 978, 1044, 873, 648, 503, 305, 722, 1197, 678, 194, 331, 237, 805, 466, 706, 250, 255, 102, 288, 155, 40, 245, 556, 431, 243, 517, 569, 586, 681, 1000, 375, 691, 0, 272, 322, 737, 137, 1030, 548, 523, 861, 306, 515, 70, 1136, 496, 1072, 1005, 1083, 769, 997, 295, 299, 624, 856, 1147, 1068, 1135, 107, 832, 598, 302, 537, 926, 283, 531, 813, 699, 830, 863, 1029, 182, 494, 352, 1203, 638, 7, 163, 1066, 566, 789, 472, 999, 710, 50, 73, 924, 1185, 1156, 936, 308, 881, 656, 203, 454, 1054, 145, 567, 744, 1026, 1076, 428, 354, 1119, 219, 364, 825, 215, 456, 1036, 391, 333, 1017, 995, 942, 990, 493, 392, 723, 502, 164, 759, 1110, 146, 899, 498, 1176, 1157, 141, 328, 408, 59, 658, 274, 747, 60, 1077, 584, 982, 642, 712, 617, 139, 292, 952, 665, 1116, 1001, 596, 967, 401, 859, 671, 323, 1081, 1178, 110, 463, 397, 383, 991, 634, 118, 970, 1172, 225, 1050, 1101, 897, 167, 787, 1045, 487, 13, 641, 559, 928, 446, 483, 887, 1162, 631, 488, 705, 343, 368, 26, 521, 201, 1065, 771, 88, 1061, 782, 84, 1177, 895, 557, 316, 1209, 179, 758, 677, 674, 1126, 165, 202, 1102, 1105, 1064, 76, 650, 530, 501, 1142, 867, 874, 1035, 925, 730, 320, 937, 546, 160, 457, 116, 1206, 406, 980, 56, 224, 901, 1093, 373, 123, 663, 611, 834, 943, 538, 175, 810, 1056, 345, 694, 756, 932, 450, 953, 253, 704, 412, 486, 300, 532, 297, 120, 1213, 959, 994, 1086, 828, 526, 522, 708, 762, 1174, 1085, 285, 845, 178, 562, 346, 117, 1107, 358, 968, 1159, 133, 359, 835, 393, 459, 582, 1082, 1089, 882, 451, 1009, 1179, 1165, 425, 1148, 606, 434, 131, 24, 742, 191, 1080, 885, 821, 981, 544, 746, 511, 196, 647, 639, 814, 1027, 623, 568, 872, 869, 324, 444, 597, 78, 866, 330, 985, 353, 589, 379, 536, 664, 738, 485, 564, 686, 1182, 751, 176, 277, 1133, 1132, 142, 1067, 620, 776, 644, 347, 317, 309, 424, 703, 497, 632, 799, 187, 336, 436, 66, 1059, 407, 724, 82, 851]
torch.Size([22])
torch.Size([22])
torch.Size([9])
torch.Size([9])
TWIG_Base(
  (linear_struct_1): Linear(in_features=23, out_features=10, bias=True)
  (relu_1): ReLU()
  (linear_struct_2): Linear(in_features=10, out_features=10, bias=True)
  (relu_2): ReLU()
  (linear_hps_1): Linear(in_features=9, out_features=6, bias=True)
  (relu_3): ReLU()
  (linear_integrate_1): Linear(in_features=16, out_features=8, bias=True)
  (relu_4): ReLU()
  (linear_final): Linear(in_features=8, out_features=1, bias=True)
  (sigmoid_final): Sigmoid()
)
Training with epochs in stages 1: 2 and 2: 3
Epoch 1 -- 
running batch: 0
UMLS 2.1 1022
rank avg (pred, true): 0.585, 0.437
rank std (pred, true): 0.002, 0.264
mrr vals (pred, true): 0.013, 0.039
avg losses (mrrl, rdl): 0.0, 1.98481e-05
pnt losses (mrrl, rdl): 0.0, 1.98481e-05

